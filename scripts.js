function negQueryPost(query) {
    var xhr = new XMLHttpRequest();
    xhr.open('POST', 'queryParseServlet?query=' + query);
    xhr.onload = function() {
        if(xhr.readyState === 4 && xhr.status === 200) {
            //Response was OK
            if(xhr.responseText === query) {
                console.log("I received the query I sent");
            }else{
                alert(xhr.responseText);
            }
        }else if(xhr.status !== 200) {
            alert('Request failed with code: '+xhr.status);
        }
    };
    xhr.setRequestHeader('Content-Type','application/x-www-form-urlencoded');
    xhr.send();
}

// Bing Search API
function bing() {
    $(function () {
        var query = $("#query").val();
        var params = {
            // Request parameters
            "q": query,
            "count": "10",
            "offset": "0",
            "mkt": "en-us",
            "safeSearch": "Moderate"
        };

        $.ajax({
            url: "https://api.cognitive.microsoft.com/bing/v5.0/search?" + $.param(params),
            beforeSend: function (xhrObj) {
                // Request headers
                xhrObj.setRequestHeader("Ocp-Apim-Subscription-Key", "e004b718ecbe423892f7da4e7b6a202c");
            },
            type: "GET",
            // Request body
            data: "{body}"
        })
            .done(function (data) {
                console.log(data);
                var results = data.webPages.value;
                var nl = "<p>";

                $("#searchL").html("<center><font size='4' style='font-weight: bold'>Original Query</font></center>");
                for(var i = 0; i < results.length; i++) {
                    var content = "<li class='unstyled'>";
                    content += nl + "<font size='3'><a href='"+ results[i].url +"'><b>" + results[i].name + "</b></a></font>";
                    content += nl + "<font size='2'><b id='green'>" + results[i].displayUrl + "</b>";
                    content += nl + results[i].snippet + "</font>" + nl;
                    content += "</li>";
                    document.getElementById("searchL").innerHTML += content;
                }
                negQueryPost(query);

            })
            .fail(function () {
                alert("error");
            });
    });
}