/* 
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */

// TODO: Change this to async and use callback to post the results
function httpGet(theUrl) {
    var xmlHttp = new XMLHttpRequest();
    xmlHttp.open( "GET", theUrl, false ); // false for synchronous request
    xmlHttp.send( null );
    return xmlHttp.responseText;
}

function notGoogleSearch() {
    var totallyLegalSearch = document.createElement( 'html' );
    var words = ($('#query').val()).split(' ');
    var query = '';
    for (var i = 0; i < words.length; i = i + 1) {
        query = query + words[i];
        // This let's us only add '+' when needed
        if(i !== words.length - 1) query = query + '+';
    }
    var url = 'https://www.google.gr/search?q=' + query;
    totallyLegalSearch.innerHTML = httpGet(url);
    var divs = totallyLegalSearch.getElementsByClassName('rc');
    var nl = "<p>";
    for (var i = 0; i < divs.length; i = i + 1) {
        var result = document.createElement('div');
        
        // Unwrap the info we want from each result
        var result = "<li class='unstyled'>";
                    result += nl + "<font size='3'><a href='"+ divs[i].getElementsByClassName('_Rm')[0]['innerText'] +"'><b>" + divs[i].getElementsByClassName('r')[0]['innerText'] + "</b></a></font>";
                    result += nl + "<font size='2'><b id='green'>" + divs[i].getElementsByClassName('_Rm')[0]['innerText'] + "</b>";
                    result += nl + divs[i].getElementsByClassName('st')[0]['innerText'] + "</font>" + nl;
                    result += "</li>";
        // Populate our results
        $('#populateMe').append(result);
        
        //console.log(divs[i].getElementsByClassName('st')[0]['innerText']); // This gets all the info as an obj divs[i].getElementsByClassName('r')
    } 
}